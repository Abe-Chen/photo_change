# 人物姿势改变应用

## 项目概述

本应用旨在提供一个能够让用户上传人物图片，并自动或手动调整人物姿势的工具。应用将利用先进的人体姿态估计技术，实现高精度的人物关键点识别和姿势调整功能。

## 技术选型

### 前端技术

- **框架**：React.js + TypeScript
- **UI组件库**：Material-UI
- **状态管理**：Redux
- **路由管理**：React Router
- **图像处理**：Canvas API, Konva.js
- **文件上传**：react-dropzone

### 后端技术

- **框架**：Spring Boot
- **API设计**：RESTful API
- **数据库**：MongoDB（存储用户数据和姿势模板）
- **图像处理**：OpenCV
- **人体姿态估计**：MediaPipe, TensorFlow.js

### 部署技术

- **容器化**：Docker
- **CI/CD**：GitHub Actions
- **云服务**：AWS/阿里云

## 系统架构

### 整体架构

```
+------------------+     +------------------+     +------------------+
|                  |     |                  |     |                  |
|  前端应用        | <-> |  后端服务        | <-> |  数据存储        |
|  (React.js)      |     |  (Spring Boot)   |     |  (MongoDB)       |
|                  |     |                  |     |                  |
+------------------+     +------------------+     +------------------+
                                  |
                                  v
                         +------------------+
                         |                  |
                         |  人体姿态估计    |
                         |  (MediaPipe/TF)  |
                         |                  |
                         +------------------+
```

### 模块设计

1. **用户界面模块**
   - 图片上传组件
   - 姿势模板选择组件
   - 关键点编辑组件
   - 结果预览与下载组件

2. **图像处理模块**
   - 图像预处理
   - 人物分割
   - 关键点检测
   - 姿势变换

3. **姿势模板模块**
   - 预设姿势库
   - 自定义姿势保存

4. **用户管理模块**
   - 用户认证
   - 历史记录

## 核心算法

### 人体姿态估计

使用MediaPipe或TensorFlow.js的PoseNet模型进行人体关键点检测，包括：
- 头部、颈部、肩膀
- 手肘、手腕
- 臀部、膝盖、脚踝

### 姿势变换算法

1. **骨架变形**：基于检测到的关键点构建骨架，通过仿射变换调整骨架结构
2. **图像变形**：使用As-Rigid-As-Possible (ARAP)变形算法保持图像局部刚性
3. **纹理映射**：将原始图像纹理映射到变形后的骨架上

## 用户界面设计

### 主界面

```
+---------------------------------------------------------------+
|  应用标题栏                                           用户信息  |
+---------------------------------------------------------------+
|                                                               |
|  +-------------------+        +-------------------------+     |
|  |                   |        |                         |     |
|  |  上传区域         |        |  预览区域               |     |
|  |                   |        |                         |     |
|  |  拖拽图片到此处   |        |                         |     |
|  |  或点击选择文件   |        |                         |     |
|  |                   |        |                         |     |
|  +-------------------+        +-------------------------+     |
|                                                               |
|  +-----------------------------------------------------------+
|  |  姿势模板选择区                                           |
|  |  +-------+  +-------+  +-------+  +-------+  +-------+  |
|  |  |模板1  |  |模板2  |  |模板3  |  |模板4  |  |更多... |  |
|  |  +-------+  +-------+  +-------+  +-------+  +-------+  |
|  +-----------------------------------------------------------+
|                                                               |
|  +-----------------------------------------------------------+
|  |  编辑工具栏                                               |
|  |  [移动] [旋转] [缩放] [微调关键点] [重置] [撤销] [重做]   |
|  +-----------------------------------------------------------+
|                                                               |
|  +-----------------------------------------------------------+
|  |  操作按钮                                                 |
|  |  [应用变换]                [下载图片]                      |
|  +-----------------------------------------------------------+
|                                                               |
+---------------------------------------------------------------+
```

### 关键点编辑界面

```
+---------------------------------------------------------------+
|  返回主界面                                         保存修改   |
+---------------------------------------------------------------+
|                                                               |
|  +-------------------+        +-------------------------+     |
|  |                   |        |                         |     |
|  |  原始图像         |        |  编辑预览               |     |
|  |  (显示关键点)     |        |  (实时更新)             |     |
|  |                   |        |                         |     |
|  |                   |        |                         |     |
|  |                   |        |                         |     |
|  +-------------------+        +-------------------------+     |
|                                                               |
|  +-----------------------------------------------------------+
|  |  关键点列表                                               |
|  |  [头部] [颈部] [左肩] [右肩] [左肘] [右肘] ...           |
|  +-----------------------------------------------------------+
|                                                               |
|  +-----------------------------------------------------------+
|  |  参数调整                                                 |
|  |  角度: [______] 缩放: [______] 位置X: [______] Y: [______]|
|  +-----------------------------------------------------------+
|                                                               |
+---------------------------------------------------------------+
```

## 开发进度计划

### 第一阶段：基础架构搭建（2周）

- 搭建前端项目框架
- 搭建后端服务框架
- 设计数据库结构
- 实现基本的API接口

### 第二阶段：核心功能开发（4周）

- 实现图片上传和预处理
- 集成人体姿态估计模型
- 开发姿势模板系统
- 实现基本的姿势变换功能

### 第三阶段：用户界面开发（3周）

- 实现主界面和各功能组件
- 开发关键点编辑工具
- 实现实时预览功能
- 完善用户交互体验

### 第四阶段：优化和测试（3周）

- 性能优化
- 兼容性测试
- 用户体验测试
- Bug修复

### 第五阶段：部署和上线（2周）

- 系统部署
- 文档编写
- 用户指南制作
- 正式上线

## 风险评估与应对策略

### 技术风险

1. **人体姿态估计精度不足**
   - 应对：结合多种模型，优化检测算法，提供手动调整功能

2. **图像变形质量不佳**
   - 应对：采用先进的图像处理算法，增加纹理保持和边缘保护机制

3. **性能瓶颈**
   - 应对：优化算法实现，考虑使用WebAssembly加速计算，实现部分功能的服务器端处理

### 项目风险

1. **开发周期延长**
   - 应对：合理规划里程碑，优先实现核心功能，采用敏捷开发方法

2. **用户体验不佳**
   - 应对：早期进行用户测试，收集反馈，迭代优化

## 扩展功能（未来规划）

1. **批量处理**：支持多图片同时处理
2. **动画生成**：支持生成姿势变化动画
3. **社区分享**：用户可分享自定义姿势模板
4. **AI辅助创作**：智能推荐适合的姿势
5. **3D模型支持**：扩展到3D人物模型的姿势调整

## 结论

本应用将结合先进的计算机视觉技术和直观的用户界面，为用户提供高质量的人物姿势调整功能。通过精心的设计和实现，我们将确保应用具有良好的性能、稳定性和用户体验。

## 部署指南

### 快速开始

#### 方法一：使用启动脚本（开发环境）

```bash
chmod +x start.sh
./start.sh
```

#### 方法二：使用部署脚本（生产环境）

```bash
chmod +x build_and_deploy.sh
./build_and_deploy.sh
```

按照提示选择部署方式：
1. 创建部署包 - 生成可部署到服务器的ZIP文件
2. 使用Docker部署 - 在本地使用Docker容器运行应用

#### 方法三：使用Docker Compose

```bash
docker-compose up -d
```

### 详细部署说明

详细的部署说明请参考：

- [部署指南](DEPLOYMENT.md) - 包含多种部署方式的说明
- [详细部署文档](docs/deployment_guide.md) - 包含服务器配置和部署步骤